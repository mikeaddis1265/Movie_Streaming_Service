@url = http://localhost:3000
@json = Content-Type: application/json
@email = test1@example.com
@password = StrongPassw0rd1

### Register
POST {{url}}/api/auth/register
{{json}}

{
  "email": "{{email}}",
  "password": "{{password}}",
  "name": "Test User"
}

### Fetch latest verification token (dev only)
GET {{url}}/api/auth/dev/latest-token?email={{email}}

### Verify email using token (GET)
# Replace TOKEN below from previous response if REST client cannot chain variables
GET {{url}}/api/auth/verify-email?token=38b68b58182482b44b78723d2ed8f58ae7b37c335034f5cf1b24a78372667e23

### Verify email using token (POST)
# If your REST client supports variables, paste the token
POST {{url}}/api/auth/verify-email
{{json}}

{
  "token": "38b68b58182482b44b78723d2ed8f58ae7b37c335034f5cf1b24a78372667e23"
}

### Login with credentials via NextAuth (optional; requires manual CSRF copy)
# 1) Get CSRF token
GET {{url}}/api/auth/csrf

### 2) Login with form-encoded body
# Copy the csrfToken value from previous response
POST {{url}}/api/auth/callback/credentials
Content-Type: application/x-www-form-urlencoded

csrfToken=CSRF_TOKEN&email={{email}}&password={{password}}&callbackUrl={{url}}&json=true

### Check session (requires cookies support in REST client)
GET {{url}}/api/auth/session

### Forgot password
POST {{url}}/api/auth/forgot-password
{{json}}

{
  "email": "{{email}}"
}

### Fetch latest reset token (dev only)
GET {{url}}/api/auth/dev/latest-token?email={{email}}

### Reset password
POST {{url}}/api/auth/reset-password
{{json}}

{
  "token": "TOKEN",
  "newPassword": "NewStrongPassw0rd1"
}